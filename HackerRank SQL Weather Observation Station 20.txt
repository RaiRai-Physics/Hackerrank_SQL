HackerRank SQL: Weather Observation Station 20

Question Link: https://www.hackerrank.com/challenges/weather-observation-station-20/problem?isFullScreen=true

/*
Enter your query here.
*/
select round(avg(lat_n), 4)
from (
select lat_n,
row_number() over(order by lat_n) as rn,
count(*) over() as total_rows
from station
) t
where rn in (floor((total_rows + 1) / 2),
floor((total_rows + 2) / 2));
